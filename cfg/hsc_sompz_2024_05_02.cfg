#------------------------------------MODIFY THIS FOR YOUR RUN------------------------------------------
# hsc_sompz.cfg: HSC Y1 data run

#### basic configuration of the run
debug : True # if True, use as little data as possible to increase wall-clock time 
run_name : 'hsc'
data_dir : '/Users/jmyles/data/hsc/sompz'
out_dir  : '/Users/jmyles/data/sompz_desc/2024-05-02/'

# keys of bands in deep photometry catalog
deep_bands: ['u', 'g', 'r', 'i', 'z', 'j', 'h', 'k'] # 'y'
deep_bands_label: 'deep_flux_'
deep_bands_err_label: 'deep_flux_err_'

# keys of bands in wide photometry catalog
wide_bands : ['g','r', 'i', 'z', 'y']
wide_bands_label: 'flux_'
wide_bands_err_label : 'flux_err_'

# shear types in the wide catalog
shear_types : ['noshear/',]

# path to each shear catalog inside the wide catalog
wide_h5_path: '/catalog/'

## wide SOM configuration and name
wide_som_dim : 64
wide_som_size : 4096
som_wide : 'som_wide_64_64_1e7.npy'

# deep SOM  configuration and name
deep_som_dim : 32
deep_som_size : 256
som_deep : 'som_deep_32_32.npy'

# number of tomographic bins and Y3 SOMF bin edges
n_bins : 4
bin_edges : [0.0, 0.405, 0.665, 0.96, 2.0]  

# settings for output histogram - note that zbins_max needs to agree with Laigle currently
zbins_max : 6.00
zbins_dz  : 0.01

# all z-bins above zmax_pileup will be piled into this last bin
# Can up or downweight the last bin
zmax_pileup : 3.0
zmax_weight : 1.0

# the zero point of the catalog fluxes. NOT TO BE CONFUSED WITH zp (see below), the zero point used to interpret the depth map used to make noisy Buzzard fluxes.
zp_catalog : 30

# catalogs used to train and populate SOMs
z_file : '/Users/jmyles/data/hsc/sompz/2024-05-02/spec_data_pd.h5'
deep_balrog_file : '/Users/jmyles/data/hsc/sompz/2024-05-02/balrog_data.p'
balrog_file : '/Users/jmyles/data/hsc/sompz/2024-05-02/balrog_data.p'
wide_file : '/Users/jmyles/data/hsc/sompz/2024-05-02/wide_data.h5'
smooth_response_filename : '/Users/jmyles/data/hsc/sompz/y6_shape_response_grid.txt'

# files containing the cell assignment information
deep_cells_assignment_balrog_file : 'cells_deep_deep_balrog_hsc.pkl'
wide_cells_assignment_balrog_file : 'cells_wide_deep_balrog_hsc.pkl'
wide_cells_assignment_wide_file : 'cells_wide_noshear_hsc.pkl'

# files containing the cell assignment information

# number of wide galaxies used for training wide SOM
nwide_train : 100000 # 1000000

# matching radius in arcsec for deep matched to redshift
matchlim : 0.75


#### weighting done in Y3
weight_pcchat_response : False     # if True, reweight Balrog pairs by shear response for transfer matrix
weight_pcchat_injections : False   # if True, reweight Balrog pairs by inverse of number of times deep galaxy was injected
weight_pcchat_shearweight : False  # if True, reweight Balrog pairs by the SNR-size based metacal shear weight
weight_pzc_response : False        # if True, reweight redshift sample by shear response for p(z|c)
weight_pzc_injections : False      # if True, reweight redshifts by inverse of the number of times deep galaxy was injected for p(z|c)
weight_pzc_shearweight : False     # if True, reweight redshifts by the SNR-size based metacal shear weight
weight_pchatb_response : False     # if True, reweight wide cells by mean response for binned n(z)
weight_pchatb_shearweight : False  # if True, reweight wide cells by mean SNR-size based metacal shear weight for binned n(z)
weight_smoothR : False             # if True, smooth the response weight